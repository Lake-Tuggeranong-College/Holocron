/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var A=Object.defineProperty;var Ee=Object.getOwnPropertyDescriptor;var Pe=Object.getOwnPropertyNames;var ye=Object.prototype.hasOwnProperty;var Fe=(i,t)=>{for(var n in t)A(i,n,{get:t[n],enumerable:!0})},ve=(i,t,n,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Pe(t))!ye.call(i,a)&&a!==n&&A(i,a,{get:()=>t[a],enumerable:!(e=Ee(t,a))||e.enumerable});return i};var Ce=i=>ve(A({},"__esModule",{value:!0}),i);var Se={};Fe(Se,{default:()=>D});module.exports=Ce(Se);var be=require("obsidian");var h=require("obsidian"),O={showFileInfo:!0,showShowInFileExplorer:!0,showRenameOption:!0,showOpenInNewTab:!0,showOpenInDefaultApp:!0,showPercentageResize:!0,customResizeWidths:[],cmdCtrlClickBehavior:"open-in-new-tab",enableWheelZoom:!0,wheelModifierKey:"Alt",wheelZoomPercentage:20,invertScrollDirection:!1,externalEditorName:"",externalEditorPathMac:"",externalEditorPathWin:"",debugMode:!1};function F(i){return h.Platform.isMacOS?i.externalEditorPathMac:i.externalEditorPathWin}var y=class extends h.PluginSettingTab{constructor(t,n){super(t,n),this.plugin=n}async display(){let{containerEl:t}=this;t.empty(),new h.Setting(t).setName("Menu options").setHeading(),new h.Setting(t).setName("Show file information").setDesc("Show file information in the context menu").addToggle(e=>{e.setValue(this.plugin.settings.showFileInfo).onChange(async a=>{this.plugin.settings.showFileInfo=a,await this.plugin.saveSettings()})}),new h.Setting(t).setName("Show in file explorer").setDesc("Show option to reveal image in system file explorer").addToggle(e=>e.setValue(this.plugin.settings.showShowInFileExplorer).onChange(async a=>{this.plugin.settings.showShowInFileExplorer=a,await this.plugin.saveSettings()})),new h.Setting(t).setName("Show rename option").setDesc("Show option to rename image file").addToggle(e=>e.setValue(this.plugin.settings.showRenameOption).onChange(async a=>{this.plugin.settings.showRenameOption=a,await this.plugin.saveSettings()})),new h.Setting(t).setName("Show open in new tab").setDesc("Show option to open image in new tab").addToggle(e=>e.setValue(this.plugin.settings.showOpenInNewTab).onChange(async a=>{this.plugin.settings.showOpenInNewTab=a,await this.plugin.saveSettings()})),new h.Setting(t).setName("Show open in default app").setDesc("Show option to open image in default app").addToggle(e=>e.setValue(this.plugin.settings.showOpenInDefaultApp).onChange(async a=>{this.plugin.settings.showOpenInDefaultApp=a,await this.plugin.saveSettings()})),new h.Setting(t).setName("Show percentage resize").setDesc("Show percentage resize options (100%, 50%, 25%) in the context menu. Custom sizes will always be shown if defined.").addToggle(e=>e.setValue(this.plugin.settings.showPercentageResize).onChange(async a=>{this.plugin.settings.showPercentageResize=a,await this.plugin.saveSettings()})),new h.Setting(t).setName("Custom resize width").setDesc("Set custom resize widths in pixels (comma-separated, e.g. 600,800,1200)").addText(e=>{e.setPlaceholder("e.g., 600,800,1200").setValue(this.plugin.settings.customResizeWidths.length>0?this.plugin.settings.customResizeWidths.join(","):"").onChange(async a=>{let o=a.split(",").map(s=>parseInt(s.trim())).filter(s=>!isNaN(s)&&s>0);this.plugin.settings.customResizeWidths=o,await this.plugin.saveSettings()})}).addText(e=>{e.inputEl.addClass("pixel-perfect-px-suffix"),e.setValue("px"),e.setDisabled(!0)});let n=h.Platform.isMacOS?"CMD":"CTRL";new h.Setting(t).setName(`${n} + click behavior`).setDesc(`Choose what happens when you ${n} + click an image`).addDropdown(e=>{let a=this.plugin.settings.externalEditorName.trim()||"external editor";e.addOption("open-in-new-tab","Open in new tab").addOption("open-in-default-app","Open in default app").addOption("open-in-external-editor",`Open in ${a}`).setValue(this.plugin.settings.cmdCtrlClickBehavior).onChange(async o=>{this.plugin.settings.cmdCtrlClickBehavior=o,await this.plugin.saveSettings()})}),new h.Setting(t).setName("Mousewheel zoom").setHeading(),new h.Setting(t).setName("Enable mousewheel zoom").setDesc("Hold modifier key and scroll to resize images").addToggle(e=>{e.setValue(this.plugin.settings.enableWheelZoom).onChange(async a=>{this.plugin.settings.enableWheelZoom=a,await this.plugin.saveSettings()})}),new h.Setting(t).setName("Modifier key").setDesc("Key to hold while scrolling to zoom images").addDropdown(e=>{let a=h.Platform.isMacOS;e.addOption("Alt",a?"Option":"Alt").addOption("Ctrl","Ctrl").addOption("Shift","Shift").setValue(this.plugin.settings.wheelModifierKey).onChange(async o=>{this.plugin.settings.wheelModifierKey=o,await this.plugin.saveSettings()})}),new h.Setting(t).setName("Zoom step size").setDesc("Percentage to zoom per scroll step").addExtraButton(e=>{e.setIcon("reset").setTooltip("Reset to default").onClick(async()=>{this.plugin.settings.wheelZoomPercentage=O.wheelZoomPercentage,await this.plugin.saveSettings(),this.display()})}).addSlider(e=>{var s;let a=createSpan();a.addClass("pixel-perfect-zoom-value");let o=r=>{a.setText(`${r}%`)};e.setDynamicTooltip().setLimits(1,100,1).setValue(this.plugin.settings.wheelZoomPercentage).onChange(async r=>{o(r),this.plugin.settings.wheelZoomPercentage=r,await this.plugin.saveSettings()}),o(this.plugin.settings.wheelZoomPercentage),(s=e.sliderEl.parentElement)==null||s.prepend(a)}),new h.Setting(t).setName("Invert scroll direction").setDesc("Invert the zoom direction when scrolling").addToggle(e=>{e.setValue(this.plugin.settings.invertScrollDirection).onChange(async a=>{this.plugin.settings.invertScrollDirection=a,await this.plugin.saveSettings()})}),new h.Setting(t).setName("External editor").setHeading(),new h.Setting(t).setName("External editor name").setDesc("Name of your external editor (e.g., Photoshop)").addText(e=>{e.setPlaceholder("Photoshop").setValue(this.plugin.settings.externalEditorName).onChange(async a=>{this.plugin.settings.externalEditorName=a,await this.plugin.saveSettings()})}),h.Platform.isMacOS&&new h.Setting(t).setName("External editor path (macOS)").setDesc("Full path to your external editor application on macOS").addText(e=>{e.setPlaceholder("/Applications/Adobe Photoshop 2025/Adobe Photoshop 2025.app").setValue(this.plugin.settings.externalEditorPathMac).onChange(async a=>{let o=a.replace(/\\ /g," ");this.plugin.settings.externalEditorPathMac=o,await this.plugin.saveSettings()})}),h.Platform.isWin&&new h.Setting(t).setName("External editor path (Windows)").setDesc("Full path to your external editor application on Windows").addText(e=>{e.setPlaceholder("C:\\Program Files\\Adobe\\Adobe Photoshop 2025\\Photoshop.exe").setValue(this.plugin.settings.externalEditorPathWin).onChange(async a=>{let o=a.replace(/\\ /g," ");this.plugin.settings.externalEditorPathWin=o,await this.plugin.saveSettings()})}),new h.Setting(t).setName("Developer").setHeading(),new h.Setting(t).setName("Debug mode").setDesc("Enable debug logging to console").addToggle(e=>{e.setValue(this.plugin.settings.debugMode).onChange(async a=>{this.plugin.settings.debugMode=a,await this.plugin.saveSettings()})})}};var E=require("obsidian");function f(i){return!i||!(i instanceof HTMLElement)?null:i instanceof HTMLImageElement?i:i.matches('.image-container, .image-embed, img, a.internal-embed[src*=".png"], a.internal-embed[src*=".jpg"], a.internal-embed[src*=".jpeg"], a.internal-embed[src*=".gif"], a.internal-embed[src*=".webp"], a.internal-embed[src*=".svg"]')?i.querySelector("img"):null}function m(...i){let t=new Date().toTimeString().split(" ")[0];console.error(`${t}`,...i)}function b(i){this.isModifierKeyHeld=i}function j(i){this.wheelEventCleanup&&(this.wheelEventCleanup(),this.wheelEventCleanup=null);let t=i.document,n=r=>{v.call(this,r)&&b.call(this,!0)},e=r=>{v.call(this,r)&&b.call(this,!1)},a=()=>{this.isModifierKeyHeld&&b.call(this,!1)},o=async r=>{if(!this.settings.enableWheelZoom||!this.isModifierKeyHeld)return;if(!R.call(this,r)){b.call(this,!1);return}let l=f(r.target);if(l){r.preventDefault();try{await H.call(this,r,l)}catch(c){m("Error handling wheel event:",c),new E.Notice("Failed to resize image")}}};this.registerDomEvent(t,"keydown",n),this.registerDomEvent(t,"keyup",e),this.registerDomEvent(window,"blur",a);let s=new AbortController;t.addEventListener("wheel",o,{passive:!1,signal:s.signal}),this.register(()=>s.abort()),this.wheelEventCleanup=()=>{s.abort()}}function v(i){let t=this.settings.wheelModifierKey.toLowerCase(),n=i.key.toLowerCase();switch(t){case"alt":return n==="alt"||n==="option";case"ctrl":return n==="ctrl"||n==="control";case"shift":return n==="shift";default:return!1}}function R(i){switch(this.settings.wheelModifierKey.toLowerCase()){case"alt":return i.altKey;case"ctrl":return i.ctrlKey;case"shift":return i.shiftKey;default:return!1}}async function H(i,t){if(!this.settings.enableWheelZoom)return;let n=this.app.workspace.getActiveViewOfType(E.MarkdownView);if(!(n!=null&&n.file))return;let e=await this.getImageFileWithErrorHandling(t);if(!e)return;let{width:a}=await this.readImageDimensions(e.imgFile),o=this.getCurrentImageWidth(t,e.activeFile,e.imgFile),s=o!=null?o:a,r=Math.min(1,Math.abs(i.deltaY)/10),l=Math.max(1,Math.round(s*(this.settings.wheelZoomPercentage/100)*r)),c=i.deltaY<0,w=(this.settings.invertScrollDirection?!c:c)?s+l:Math.max(1,s-l);w!==s&&await this.updateImageLinkWidth(e.imgFile,w)}function U(i){if(!(i.metaKey||i.ctrlKey))return;let t=f(i.target);t&&(i.preventDefault(),this.getImageFileWithErrorHandling(t).then(n=>{n&&(this.settings.cmdCtrlClickBehavior==="open-in-new-tab"?this.app.workspace.openLinkText(n.imgFile.path,"",!0):this.settings.cmdCtrlClickBehavior==="open-in-default-app"?this.openInDefaultApp(n.imgFile):this.settings.cmdCtrlClickBehavior==="open-in-external-editor"&&this.openInExternalEditor(n.imgFile.path))}).catch(n=>{let e="perform action";this.settings.cmdCtrlClickBehavior==="open-in-new-tab"?e="open image in new tab":this.settings.cmdCtrlClickBehavior==="open-in-default-app"?e="open image in default app":this.settings.cmdCtrlClickBehavior==="open-in-external-editor"&&(e=`open image in ${this.settings.externalEditorName.trim()||"external editor"}`),m(`Failed to ${e}:`,n),new E.Notice(`Failed to ${e}`)}))}var d=require("obsidian");var X=[100,50,25],C=/(!\[\[)([^\]]+)(\]\])/g,M=/!\[([^\]]*)\]\(([^)]+)\)/g;var J=require("path"),Q=require("obsidian");function q(){this.registerDomEvent(document,"contextmenu",S.bind(this));let i,t=!1;this.registerDomEvent(document,"touchstart",n=>{n.touches.length>1||!f(n.target)||(t=!1,i=setTimeout(()=>{t=!0,S.call(this,n)},500))}),this.registerDomEvent(document,"touchend",()=>{clearTimeout(i)}),this.registerDomEvent(document,"touchmove",()=>{clearTimeout(i)})}async function S(i){if("touches"in i&&i.touches.length>1)return;let t=f(i.target);if(!t)return;i.preventDefault();let n=new d.Menu;await z.call(this,n,t),await $.call(this,n,i),d.Platform.isMobile||(n.addSeparator(),V.call(this,n,t));let e={x:i instanceof MouseEvent?i.pageX:i.touches[0].pageX,y:i instanceof MouseEvent?i.pageY:i.touches[0].pageY};n.showAtPosition(e)}function Y(i,t,n){i.addItem(e=>{e.setTitle(t).setIcon(n).setDisabled(!0)})}async function z(i,t){if(this.settings.showFileInfo)try{let n=await this.getImageFileWithErrorHandling(t);if(!n)return;let{width:e,height:a}=await this.readImageDimensions(n.imgFile),o=this.calculateImageScale(t,n.activeFile,n.imgFile,e),s=o!==null?` @ ${o}%`:"";Y(i,`${n.imgFile.name}${s}`,"image-file"),Y(i,`${e} \xD7 ${a} px`,"info")}catch(n){m("Could not read dimensions:",n),new d.Notice("Could not read image dimensions")}}function K(i,t){return async()=>{try{await i()}catch(n){m(t,n);let e=n instanceof Error?n.message:t;new d.Notice(e)}}}function p(i,t,n,e,a,o=!1){i.addItem(s=>{s.setTitle(t).setIcon(n).setDisabled(o).onClick(K.call(this,e,a))})}async function $(i,t){let n=f(t.target);if(!n)return;p.call(this,i,"Copy image","copy",async()=>{await this.copyImageToClipboard(n),new d.Notice("Image copied to clipboard")},"Failed to copy image to clipboard"),p.call(this,i,"Copy local path","link",async()=>{let s=await this.getImageFileWithErrorHandling(n);if(!s)return;let r=this.app.vault.adapter.basePath,l=(0,J.join)(r,(0,Q.normalizePath)(s.imgFile.path));await navigator.clipboard.writeText(l),new d.Notice("File path copied to clipboard")},"Failed to copy file path"),i.addSeparator();let e=await this.getImageFileWithErrorHandling(n),a=null,o=null;if(e){let{width:s}=await this.readImageDimensions(e.imgFile);o=this.getCurrentImageWidth(n,e.activeFile,e.imgFile),a=o!==null?Math.round(o/s*100):null}this.settings.showPercentageResize&&X.forEach(s=>{p.call(this,i,`Resize to ${s}%`,"image",async()=>await this.resizeImage(n,s),`Failed to resize image to ${s}%`,a===s)}),this.settings.customResizeWidths.length>0&&this.settings.customResizeWidths.forEach(s=>{p.call(this,i,`Resize to ${s}px`,"image",async()=>await this.resizeImage(n,s,!0),`Failed to resize image to ${s}px`,o===s)}),e&&a!==null&&p.call(this,i,"Remove custom size","reset",async()=>{await this.removeImageWidth(e.imgFile),new d.Notice("Removed custom size from image")},"Failed to remove custom size from image")}function V(i,t){if(d.Platform.isMobile)return;let n=d.Platform.isMacOS;this.settings.showShowInFileExplorer&&p.call(this,i,n?"Show in Finder":"Show in Explorer","folder-open",async()=>{let a=await this.getImageFileWithErrorHandling(t);a&&await this.showInSystemExplorer(a.imgFile)},"Failed to open system explorer"),this.settings.showRenameOption&&p.call(this,i,"Rename image","pencil",async()=>{let a=await this.getImageFileWithErrorHandling(t);a&&await this.renameImage(a.imgFile)},"Failed to rename image"),(this.settings.showRenameOption||this.settings.showShowInFileExplorer)&&i.addSeparator(),this.settings.showOpenInNewTab&&p.call(this,i,"Open in new tab","link-2",async()=>{let a=await this.getImageFileWithErrorHandling(t);a&&await this.app.workspace.openLinkText(a.imgFile.path,"",!0)},"Failed to open image in new tab"),this.settings.showOpenInDefaultApp&&p.call(this,i,"Open in default app","image",async()=>{let a=await this.getImageFileWithErrorHandling(t);a&&await this.openInDefaultApp(a.imgFile)},"Failed to open in default app");let e=F(this.settings);if(e!=null&&e.trim()){let a=this.settings.externalEditorName.trim()||"external editor";p.call(this,i,`Open in ${a}`,"edit",async()=>{let o=await this.getImageFileWithErrorHandling(t);o&&await this.openInExternalEditor(o.imgFile.path)},`Failed to open image in ${a}`)}}var ee=require("obsidian");async function te(i,t,n=!1){let e=await this.getImageFileWithErrorHandling(i);if(!e)throw new Error("Could not find the image file");let{width:a}=await this.readImageDimensions(e.imgFile),o=n?t:Math.round(a*t/100);await this.updateImageLinkWidth(e.imgFile,o)}async function ie(i,t){let n=await this.updateImageLinks(i,e=>{let a=e.length>0?e[e.length-1]:null;return a!==null&&!isNaN(parseInt(a))?[...e.slice(0,e.length-1),String(t)]:[...e,String(t)]})}async function ne(i){let t=await this.updateImageLinks(i,n=>{let e=n.length>0?n[n.length-1]:null;return e!==null&&!isNaN(parseInt(e))?n.slice(0,n.length-1):n})}async function ae(i){if(this.dimensionCache.has(i.path))return this.dimensionCache.get(i.path);try{let t=await this.app.vault.readBinary(i),n=Me(t,"image/*"),e=URL.createObjectURL(n);try{let a=await re(e),o={width:a.width,height:a.height};return this.dimensionCache.set(i.path,o),o}finally{URL.revokeObjectURL(e)}}catch(t){throw m("Failed to read image file:",t),t}}function se(i,t,n,e){let a=this.getCurrentImageWidth(i,t,n);return a===null?null:Math.round(a/e*100)}function oe(i,t,n){var r;let e=(r=this.app.workspace.getActiveViewOfType(ee.MarkdownView))==null?void 0:r.editor;if(!e)return null;let a=e.getValue(),o=null,s=l=>{if(l.length===0)return null;let c=l[l.length-1],u=parseInt(c);return isNaN(u)?null:u};for(let l of a.matchAll(C)){let[c,u,w]=l,[G]=w.split("#",1),[L,...P]=G.split("|"),I=this.app.metadataCache.getFirstLinkpathDest(L,t.path);if((I==null?void 0:I.path)===n.path){let x=s(P);if(x!==null){o=x;break}}}if(o===null)for(let l of a.matchAll(M)){let[c,u,w]=l,[G,...L]=u.split("|"),P=w;try{P=decodeURIComponent(w)}catch(x){}let I=this.app.metadataCache.getFirstLinkpathDest(P,t.path);if((I==null?void 0:I.path)===n.path){let x=s(L);if(x!==null){o=x;break}}}return o}function re(i,t){return new Promise((n,e)=>{let a=new Image;t&&(a.crossOrigin=t),a.onload=()=>n(a),a.onerror=()=>e(new Error("Failed to load image")),a.src=i})}function Me(i,t){return new Blob([new Uint8Array(i)],{type:t})}async function le(i){try{let t=await re(i.src,"anonymous"),n=document.createElement("canvas");n.width=t.naturalWidth,n.height=t.naturalHeight;let e=n.getContext("2d");if(!e)throw new Error("Failed to get canvas context");e.drawImage(t,0,0);let a=await new Promise(s=>{n.toBlob(s)});if(!a)throw new Error("Failed to create blob");let o=new ClipboardItem({[a.type]:a});await navigator.clipboard.write([o])}catch(t){throw m("Copy to clipboard failed:",t),t instanceof Error&&t.message.includes("Document is not focused")?new Error("Please click in the editor first, then try copying again"):t}}var he=require("obsidian");function B(i,t,n,e){return i=i.replace(C,(a,o,s,r)=>{let l=T.call(this,s);if(!k.call(this,l.path,t,n))return a;l.params=e(l.params);let c=N.call(this,l);return`${o}${c}${r}`}),i.replace(M,(a,o,s)=>{let r=T.call(this,o,s);if(!k.call(this,r.path,t,n))return a;let l=o.split("|")[0].trim()||n.basename;return r.params=e(r.params),`![${r.params.length>0?[l,...r.params].join("|"):l}](${N.call(this,{...r,params:[]},!0)})`})}function T(i,t){let n=t!=null?t:i;if(t)try{n=decodeURIComponent(n)}catch(c){}let[e,a]=n.split("#",2),o=a?`#${a}`:"",[s,...r]=(t?i:e).split("|");return{path:t?e:s,hash:o,params:r,isWikiStyle:!t}}function N(i,t=!1){let n=i.params.length>0?`|${i.params.join("|")}`:"",e=i.path;return t&&(e=i.path.split("/").map(a=>encodeURIComponent(a)).join("/")),`${e}${n}${i.hash}`}async function ce(i,t){let n=this.app.workspace.getActiveFile();if(!n)throw new Error("No active file, cannot update link.");if(n.path===i.path)return!1;if(!this.app.workspace.getActiveViewOfType(he.MarkdownView))throw new Error("No active MarkdownView to update.");let a=await this.app.vault.read(n),o=a,s=-1;a.startsWith(`---
`)&&(s=a.indexOf(`
---
`,4),s!==-1&&(s+=5,o=a.substring(s)));let r=B.call(this,o,n,i,t);if(r!==o)try{return await this.app.vault.process(n,l=>s!==-1?l.substring(0,s)+r:r),!0}catch(l){throw m("Failed to update file content:",l),new Error("Failed to update image link")}return!1}function k(i,t,n){let e=this.app.metadataCache.getFirstLinkpathDest(i,t.path);return!e||n&&e.path!==n.path?null:e}var g=require("obsidian"),ge=require("path"),pe=require("child_process");var me=require("obsidian"),W=class extends me.Modal{constructor(n,e,a){super(n);this.result=null;this.originalName=e,this.onSubmit=a}onOpen(){let{contentEl:n}=this;n.empty(),n.addClass("pixel-perfect-rename-modal"),n.createEl("h2",{text:"Rename image",cls:"modal-title"});let e=n.createEl("form");e.addClass("pixel-perfect-rename-form");let a=e.createEl("input",{type:"text",value:this.originalName,cls:"pixel-perfect-rename-input"}),o=this.originalName.lastIndexOf(".");if(o>0){let c=this.originalName.substring(0,o);a.setSelectionRange(0,c.length)}let s=e.createDiv();s.addClass("pixel-perfect-button-container");let r=s.createEl("button",{text:"Rename",type:"submit",cls:"mod-cta"});s.createEl("button",{text:"Cancel",type:"button"}).addEventListener("click",()=>{this.onSubmit(null),this.close()}),e.addEventListener("submit",c=>{c.preventDefault();let u=a.value.trim();u&&u!==this.originalName?this.onSubmit(u):this.onSubmit(null),this.close()}),a.focus()}onClose(){let{contentEl:n}=this;n.empty(),this.result===void 0&&this.onSubmit(null)}};function de(i,t){var o;let n=(o=i.getAttribute("src"))!=null?o:"",e=i.getAttribute("alt"),a=_.call(this,n);if(a){let s=this.resolveLink(a,t);if(s)return s}if(e){e=e.split("|")[0].trim();let s=this.resolveLink(e,t);if(s)return s}return null}function _(i){try{let t=decodeURIComponent(i),[n]=t.split("?"),e=n.lastIndexOf("/");return e<0||e>=n.length-1?null:n.substring(e+1)}catch(t){return null}}async function ue(i){let t=this.app.workspace.getActiveFile();if(!t)return null;let n=this.getFileForImage(i,t);return n?{activeFile:t,imgFile:n}:((i.naturalWidth>0||i.src)&&new g.Notice("Could not locate image file"),null)}async function fe(i){this.app.showInFolder(i.path)}async function we(i){this.app.openWithDefaultApp(i.path)}function Ie(i){let t=F(this.settings),n=this.settings.externalEditorName.trim()||"External Editor";if(!t){new g.Notice(`Please set your ${n} path in Pixel Perfect Image settings.`);return}let e=this.app.vault.adapter;if(!(e instanceof g.FileSystemAdapter)){new g.Notice("Cannot open file: Vault is not a FileSystemAdapter");return}let a=e.getBasePath(),o=(0,ge.join)(a,(0,g.normalizePath)(i)),s;g.Platform.isMacOS?s=`open -a "${t}" "${o}"`:s=`"${t}" "${o}"`,(0,pe.exec)(s,r=>{r&&(m(`Error launching ${n}:`,r),new g.Notice(`Could not open file in ${n}.`))})}async function xe(i){var n;let t=await Z.call(this,i);if(t)try{let a=`${((n=i.parent)==null?void 0:n.path)||"/"}/${t}`;await this.app.fileManager.renameFile(i,a),new g.Notice("Image renamed successfully")}catch(e){m("Failed to rename file:",e),new g.Notice("Failed to rename image")}}async function Z(i){return new Promise(t=>{new W(this.app,i.name,e=>{t(e)}).open()})}var D=class extends be.Plugin{constructor(){super(...arguments);this.dimensionCache=new Map;this.isModifierKeyHeld=!1;this.wheelEventCleanup=null;this.setModifierKeyState=b.bind(this);this.registerWheelEvents=j.bind(this);this.isModifierKeyMatch=v.bind(this);this.isModifierKeyStillHeld=R.bind(this);this.handleImageWheel=H.bind(this);this.handleImageClick=U.bind(this);this.registerImageContextMenu=q.bind(this);this.handleContextMenu=S.bind(this);this.addDimensionsMenuItem=z.bind(this);this.addResizeMenuItems=$.bind(this);this.addFileOperationMenuItems=V.bind(this);this.addMenuItem=p.bind(this);this.createMenuClickHandler=K.bind(this);this.resizeImage=te.bind(this);this.updateImageLinkWidth=ie.bind(this);this.removeImageWidth=ne.bind(this);this.readImageDimensions=ae.bind(this);this.calculateImageScale=se.bind(this);this.getCurrentImageWidth=oe.bind(this);this.copyImageToClipboard=le.bind(this);this.updateLinks=B.bind(this);this.parseLinkComponents=T.bind(this);this.buildLinkPath=N.bind(this);this.updateImageLinks=ce.bind(this);this.resolveLink=k.bind(this);this.getFileForImage=de.bind(this);this.parseFileNameFromSrc=_.bind(this);this.getImageFileWithErrorHandling=ue.bind(this);this.showInSystemExplorer=fe.bind(this);this.openInDefaultApp=we.bind(this);this.openInExternalEditor=Ie.bind(this);this.renameImage=xe.bind(this);this.promptForNewName=Z.bind(this);this.findImageElement=f.bind(this);this.errorLog=m.bind(this)}async onload(){await this.loadSettings(),this.addSettingTab(new y(this.app,this)),this.registerImageContextMenu(),this.registerDomEvent(document,"click",this.handleImageClick),this.registerEvent(this.app.workspace.on("layout-change",()=>this.registerWheelEvents(window))),this.registerWheelEvents(window)}onunload(){this.isModifierKeyHeld=!1,this.dimensionCache.clear()}async loadSettings(){this.settings=Object.assign({},O,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}};

/* nosourcemap */