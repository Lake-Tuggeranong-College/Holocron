/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var A=Object.defineProperty;var Ee=Object.getOwnPropertyDescriptor;var Pe=Object.getOwnPropertyNames;var ye=Object.prototype.hasOwnProperty;var Fe=(i,e)=>{for(var n in e)A(i,n,{get:e[n],enumerable:!0})},Me=(i,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Pe(e))!ye.call(i,a)&&a!==n&&A(i,a,{get:()=>e[a],enumerable:!(t=Ee(e,a))||t.enumerable});return i};var ve=i=>Me(A({},"__esModule",{value:!0}),i);var Ce={};Fe(Ce,{default:()=>D});module.exports=ve(Ce);var be=require("obsidian");var h=require("obsidian"),R={showFileInfo:!0,showShowInFileExplorer:!0,showRenameOption:!0,showOpenInNewTab:!0,showOpenInDefaultApp:!0,showPercentageResize:!0,customResizeWidths:[],cmdCtrlClickBehavior:"open-in-new-tab",enableWheelZoom:!0,wheelModifierKey:"Alt",wheelZoomPercentage:20,invertScrollDirection:!1,externalEditorName:"",externalEditorPathMac:"",externalEditorPathWin:"",debugMode:!1};function F(i){return h.Platform.isMacOS?i.externalEditorPathMac:i.externalEditorPathWin}var y=class extends h.PluginSettingTab{constructor(e,n){super(e,n),this.plugin=n}async display(){let{containerEl:e}=this;e.empty(),new h.Setting(e).setName("Menu options").setHeading(),new h.Setting(e).setName("Show file information").setDesc("Show file information in the context menu").addToggle(t=>{t.setValue(this.plugin.settings.showFileInfo).onChange(async a=>{this.plugin.settings.showFileInfo=a,await this.plugin.saveSettings()})}),new h.Setting(e).setName("Show in file explorer").setDesc("Show option to reveal image in system file explorer").addToggle(t=>t.setValue(this.plugin.settings.showShowInFileExplorer).onChange(async a=>{this.plugin.settings.showShowInFileExplorer=a,await this.plugin.saveSettings()})),new h.Setting(e).setName("Show rename option").setDesc("Show option to rename image file").addToggle(t=>t.setValue(this.plugin.settings.showRenameOption).onChange(async a=>{this.plugin.settings.showRenameOption=a,await this.plugin.saveSettings()})),new h.Setting(e).setName("Show open in new tab").setDesc("Show option to open image in new tab").addToggle(t=>t.setValue(this.plugin.settings.showOpenInNewTab).onChange(async a=>{this.plugin.settings.showOpenInNewTab=a,await this.plugin.saveSettings()})),new h.Setting(e).setName("Show open in default app").setDesc("Show option to open image in default app").addToggle(t=>t.setValue(this.plugin.settings.showOpenInDefaultApp).onChange(async a=>{this.plugin.settings.showOpenInDefaultApp=a,await this.plugin.saveSettings()})),new h.Setting(e).setName("Show percentage resize").setDesc("Show percentage resize options (100%, 50%, 25%) in the context menu. Custom sizes will always be shown if defined.").addToggle(t=>t.setValue(this.plugin.settings.showPercentageResize).onChange(async a=>{this.plugin.settings.showPercentageResize=a,await this.plugin.saveSettings()})),new h.Setting(e).setName("Custom resize width").setDesc("Set custom resize widths in pixels (comma-separated, e.g. 600,800,1200)").addText(t=>{t.setPlaceholder("e.g., 600,800,1200").setValue(this.plugin.settings.customResizeWidths.length>0?this.plugin.settings.customResizeWidths.join(","):"").onChange(async a=>{let o=a.split(",").map(s=>parseInt(s.trim())).filter(s=>!isNaN(s)&&s>0);this.plugin.settings.customResizeWidths=o,await this.plugin.saveSettings()})}).addText(t=>{t.inputEl.addClass("pixel-perfect-px-suffix"),t.setValue("px"),t.setDisabled(!0)});let n=h.Platform.isMacOS?"CMD":"CTRL";new h.Setting(e).setName(`${n} + click behavior`).setDesc(`Choose what happens when you ${n} + click an image`).addDropdown(t=>t.addOption("open-in-new-tab","Open in new tab").addOption("open-in-default-app","Open in default app").setValue(this.plugin.settings.cmdCtrlClickBehavior).onChange(async a=>{this.plugin.settings.cmdCtrlClickBehavior=a,await this.plugin.saveSettings()})),new h.Setting(e).setName("Mousewheel zoom").setHeading(),new h.Setting(e).setName("Enable mousewheel zoom").setDesc("Hold modifier key and scroll to resize images").addToggle(t=>{t.setValue(this.plugin.settings.enableWheelZoom).onChange(async a=>{this.plugin.settings.enableWheelZoom=a,await this.plugin.saveSettings()})}),new h.Setting(e).setName("Modifier key").setDesc("Key to hold while scrolling to zoom images").addDropdown(t=>{let a=h.Platform.isMacOS;t.addOption("Alt",a?"Option":"Alt").addOption("Ctrl","Ctrl").addOption("Shift","Shift").setValue(this.plugin.settings.wheelModifierKey).onChange(async o=>{this.plugin.settings.wheelModifierKey=o,await this.plugin.saveSettings()})}),new h.Setting(e).setName("Zoom step size").setDesc("Percentage to zoom per scroll step").addExtraButton(t=>{t.setIcon("reset").setTooltip("Reset to default").onClick(async()=>{this.plugin.settings.wheelZoomPercentage=R.wheelZoomPercentage,await this.plugin.saveSettings(),this.display()})}).addSlider(t=>{var s;let a=createSpan();a.addClass("pixel-perfect-zoom-value");let o=r=>{a.setText(`${r}%`)};t.setDynamicTooltip().setLimits(1,100,1).setValue(this.plugin.settings.wheelZoomPercentage).onChange(async r=>{o(r),this.plugin.settings.wheelZoomPercentage=r,await this.plugin.saveSettings()}),o(this.plugin.settings.wheelZoomPercentage),(s=t.sliderEl.parentElement)==null||s.prepend(a)}),new h.Setting(e).setName("Invert scroll direction").setDesc("Invert the zoom direction when scrolling").addToggle(t=>{t.setValue(this.plugin.settings.invertScrollDirection).onChange(async a=>{this.plugin.settings.invertScrollDirection=a,await this.plugin.saveSettings()})}),new h.Setting(e).setName("External editor").setHeading(),new h.Setting(e).setName("External editor name").setDesc("Name of your external editor (e.g., Photoshop)").addText(t=>{t.setPlaceholder("Photoshop").setValue(this.plugin.settings.externalEditorName).onChange(async a=>{this.plugin.settings.externalEditorName=a,await this.plugin.saveSettings()})}),h.Platform.isMacOS&&new h.Setting(e).setName("External editor path (macOS)").setDesc("Full path to your external editor application on macOS").addText(t=>{t.setPlaceholder("/Applications/Adobe Photoshop 2025/Adobe Photoshop 2025.app").setValue(this.plugin.settings.externalEditorPathMac).onChange(async a=>{let o=a.replace(/\\ /g," ");this.plugin.settings.externalEditorPathMac=o,await this.plugin.saveSettings()})}),h.Platform.isWin&&new h.Setting(e).setName("External editor path (Windows)").setDesc("Full path to your external editor application on Windows").addText(t=>{t.setPlaceholder("C:\\Program Files\\Adobe\\Adobe Photoshop 2025\\Photoshop.exe").setValue(this.plugin.settings.externalEditorPathWin).onChange(async a=>{let o=a.replace(/\\ /g," ");this.plugin.settings.externalEditorPathWin=o,await this.plugin.saveSettings()})}),new h.Setting(e).setName("Developer").setHeading(),new h.Setting(e).setName("Debug mode").setDesc("Enable debug logging to console").addToggle(t=>{t.setValue(this.plugin.settings.debugMode).onChange(async a=>{this.plugin.settings.debugMode=a,await this.plugin.saveSettings()})})}};var E=require("obsidian");function f(i){return!i||!(i instanceof HTMLElement)?null:i instanceof HTMLImageElement?i:i.matches('.image-container, .image-embed, img, a.internal-embed[src*=".png"], a.internal-embed[src*=".jpg"], a.internal-embed[src*=".jpeg"], a.internal-embed[src*=".gif"], a.internal-embed[src*=".webp"], a.internal-embed[src*=".svg"]')?i.querySelector("img"):null}function m(...i){let e=new Date().toTimeString().split(" ")[0];console.error(`${e}`,...i)}function b(i){this.isModifierKeyHeld=i}function j(i){this.wheelEventCleanup&&(this.wheelEventCleanup(),this.wheelEventCleanup=null);let e=i.document,n=r=>{M.call(this,r)&&b.call(this,!0)},t=r=>{M.call(this,r)&&b.call(this,!1)},a=()=>{this.isModifierKeyHeld&&b.call(this,!1)},o=async r=>{if(!this.settings.enableWheelZoom||!this.isModifierKeyHeld)return;if(!O.call(this,r)){b.call(this,!1);return}let l=f(r.target);if(l){r.preventDefault();try{await H.call(this,r,l)}catch(c){m("Error handling wheel event:",c),new E.Notice("Failed to resize image")}}};this.registerDomEvent(e,"keydown",n),this.registerDomEvent(e,"keyup",t),this.registerDomEvent(window,"blur",a);let s=new AbortController;e.addEventListener("wheel",o,{passive:!1,signal:s.signal}),this.register(()=>s.abort()),this.wheelEventCleanup=()=>{s.abort()}}function M(i){let e=this.settings.wheelModifierKey.toLowerCase(),n=i.key.toLowerCase();switch(e){case"alt":return n==="alt"||n==="option";case"ctrl":return n==="ctrl"||n==="control";case"shift":return n==="shift";default:return!1}}function O(i){switch(this.settings.wheelModifierKey.toLowerCase()){case"alt":return i.altKey;case"ctrl":return i.ctrlKey;case"shift":return i.shiftKey;default:return!1}}async function H(i,e){if(!this.settings.enableWheelZoom)return;let n=this.app.workspace.getActiveViewOfType(E.MarkdownView);if(!(n!=null&&n.file))return;let t=await this.getImageFileWithErrorHandling(e);if(!t)return;let{width:a}=await this.readImageDimensions(t.imgFile),o=this.getCurrentImageWidth(e,t.activeFile,t.imgFile),s=o!=null?o:a,r=Math.min(1,Math.abs(i.deltaY)/10),l=Math.max(1,Math.round(s*(this.settings.wheelZoomPercentage/100)*r)),c=i.deltaY<0,w=(this.settings.invertScrollDirection?!c:c)?s+l:Math.max(1,s-l);w!==s&&await this.updateImageLinkWidth(t.imgFile,w)}function U(i){if(!(i.metaKey||i.ctrlKey))return;let e=f(i.target);e&&(i.preventDefault(),this.getImageFileWithErrorHandling(e).then(n=>{n&&(this.settings.cmdCtrlClickBehavior==="open-in-new-tab"?this.app.workspace.openLinkText(n.imgFile.path,"",!0):this.settings.cmdCtrlClickBehavior==="open-in-default-app"&&this.openInDefaultApp(n.imgFile))}).catch(n=>{let t=this.settings.cmdCtrlClickBehavior==="open-in-new-tab"?"open image in new tab":"open image in default app";m(`Failed to ${t}:`,n),new E.Notice(`Failed to ${t}`)}))}var d=require("obsidian");var X=[100,50,25],v=/(!\[\[)([^\]]+)(\]\])/g,S=/!\[([^\]]*)\]\(([^)]+)\)/g;var J=require("path"),Q=require("obsidian");function q(){this.registerDomEvent(document,"contextmenu",C.bind(this));let i,e=!1;this.registerDomEvent(document,"touchstart",n=>{n.touches.length>1||!f(n.target)||(e=!1,i=setTimeout(()=>{e=!0,C.call(this,n)},500))}),this.registerDomEvent(document,"touchend",()=>{clearTimeout(i)}),this.registerDomEvent(document,"touchmove",()=>{clearTimeout(i)})}async function C(i){if("touches"in i&&i.touches.length>1)return;let e=f(i.target);if(!e)return;i.preventDefault();let n=new d.Menu;await z.call(this,n,e),await $.call(this,n,i),d.Platform.isMobile||(n.addSeparator(),V.call(this,n,e));let t={x:i instanceof MouseEvent?i.pageX:i.touches[0].pageX,y:i instanceof MouseEvent?i.pageY:i.touches[0].pageY};n.showAtPosition(t)}function Y(i,e,n){i.addItem(t=>{t.setTitle(e).setIcon(n).setDisabled(!0)})}async function z(i,e){if(this.settings.showFileInfo)try{let n=await this.getImageFileWithErrorHandling(e);if(!n)return;let{width:t,height:a}=await this.readImageDimensions(n.imgFile),o=this.calculateImageScale(e,n.activeFile,n.imgFile,t),s=o!==null?` @ ${o}%`:"";Y(i,`${n.imgFile.name}${s}`,"image-file"),Y(i,`${t} \xD7 ${a} px`,"info")}catch(n){m("Could not read dimensions:",n),new d.Notice("Could not read image dimensions")}}function K(i,e){return async()=>{try{await i()}catch(n){m(e,n);let t=n instanceof Error?n.message:e;new d.Notice(t)}}}function p(i,e,n,t,a,o=!1){i.addItem(s=>{s.setTitle(e).setIcon(n).setDisabled(o).onClick(K.call(this,t,a))})}async function $(i,e){let n=f(e.target);if(!n)return;p.call(this,i,"Copy image","copy",async()=>{await this.copyImageToClipboard(n),new d.Notice("Image copied to clipboard")},"Failed to copy image to clipboard"),p.call(this,i,"Copy local path","link",async()=>{let s=await this.getImageFileWithErrorHandling(n);if(!s)return;let r=this.app.vault.adapter.basePath,l=(0,J.join)(r,(0,Q.normalizePath)(s.imgFile.path));await navigator.clipboard.writeText(l),new d.Notice("File path copied to clipboard")},"Failed to copy file path"),i.addSeparator();let t=await this.getImageFileWithErrorHandling(n),a=null,o=null;if(t){let{width:s}=await this.readImageDimensions(t.imgFile);o=this.getCurrentImageWidth(n,t.activeFile,t.imgFile),a=o!==null?Math.round(o/s*100):null}this.settings.showPercentageResize&&X.forEach(s=>{p.call(this,i,`Resize to ${s}%`,"image",async()=>await this.resizeImage(n,s),`Failed to resize image to ${s}%`,a===s)}),this.settings.customResizeWidths.length>0&&this.settings.customResizeWidths.forEach(s=>{p.call(this,i,`Resize to ${s}px`,"image",async()=>await this.resizeImage(n,s,!0),`Failed to resize image to ${s}px`,o===s)}),t&&a!==null&&p.call(this,i,"Remove custom size","reset",async()=>{await this.removeImageWidth(t.imgFile),new d.Notice("Removed custom size from image")},"Failed to remove custom size from image")}function V(i,e){if(d.Platform.isMobile)return;let n=d.Platform.isMacOS;this.settings.showShowInFileExplorer&&p.call(this,i,n?"Show in Finder":"Show in Explorer","folder-open",async()=>{let a=await this.getImageFileWithErrorHandling(e);a&&await this.showInSystemExplorer(a.imgFile)},"Failed to open system explorer"),this.settings.showRenameOption&&p.call(this,i,"Rename image","pencil",async()=>{let a=await this.getImageFileWithErrorHandling(e);a&&await this.renameImage(a.imgFile)},"Failed to rename image"),(this.settings.showRenameOption||this.settings.showShowInFileExplorer)&&i.addSeparator(),this.settings.showOpenInNewTab&&p.call(this,i,"Open in new tab","link-2",async()=>{let a=await this.getImageFileWithErrorHandling(e);a&&await this.app.workspace.openLinkText(a.imgFile.path,"",!0)},"Failed to open image in new tab"),this.settings.showOpenInDefaultApp&&p.call(this,i,"Open in default app","image",async()=>{let a=await this.getImageFileWithErrorHandling(e);a&&await this.openInDefaultApp(a.imgFile)},"Failed to open in default app");let t=F(this.settings);if(t!=null&&t.trim()){let a=this.settings.externalEditorName.trim()||"External Editor";p.call(this,i,`Open in ${a}`,"edit",async()=>{let o=await this.getImageFileWithErrorHandling(e);o&&await this.openInExternalEditor(o.imgFile.path)},`Failed to open image in ${a}`)}}var ee=require("obsidian");async function te(i,e,n=!1){let t=await this.getImageFileWithErrorHandling(i);if(!t)throw new Error("Could not find the image file");let{width:a}=await this.readImageDimensions(t.imgFile),o=n?e:Math.round(a*e/100);await this.updateImageLinkWidth(t.imgFile,o)}async function ie(i,e){let n=await this.updateImageLinks(i,t=>{let a=t.length>0?t[t.length-1]:null;return a!==null&&!isNaN(parseInt(a))?[...t.slice(0,t.length-1),String(e)]:[...t,String(e)]})}async function ne(i){let e=await this.updateImageLinks(i,n=>{let t=n.length>0?n[n.length-1]:null;return t!==null&&!isNaN(parseInt(t))?n.slice(0,n.length-1):n})}async function ae(i){if(this.dimensionCache.has(i.path))return this.dimensionCache.get(i.path);try{let e=await this.app.vault.readBinary(i),n=Se(e,"image/*"),t=URL.createObjectURL(n);try{let a=await re(t),o={width:a.width,height:a.height};return this.dimensionCache.set(i.path,o),o}finally{URL.revokeObjectURL(t)}}catch(e){throw m("Failed to read image file:",e),e}}function se(i,e,n,t){let a=this.getCurrentImageWidth(i,e,n);return a===null?null:Math.round(a/t*100)}function oe(i,e,n){var r;let t=(r=this.app.workspace.getActiveViewOfType(ee.MarkdownView))==null?void 0:r.editor;if(!t)return null;let a=t.getValue(),o=null,s=l=>{if(l.length===0)return null;let c=l[l.length-1],u=parseInt(c);return isNaN(u)?null:u};for(let l of a.matchAll(v)){let[c,u,w]=l,[G]=w.split("#",1),[L,...P]=G.split("|"),I=this.app.metadataCache.getFirstLinkpathDest(L,e.path);if((I==null?void 0:I.path)===n.path){let x=s(P);if(x!==null){o=x;break}}}if(o===null)for(let l of a.matchAll(S)){let[c,u,w]=l,[G,...L]=u.split("|"),P=w;try{P=decodeURIComponent(w)}catch(x){}let I=this.app.metadataCache.getFirstLinkpathDest(P,e.path);if((I==null?void 0:I.path)===n.path){let x=s(L);if(x!==null){o=x;break}}}return o}function re(i,e){return new Promise((n,t)=>{let a=new Image;e&&(a.crossOrigin=e),a.onload=()=>n(a),a.onerror=()=>t(new Error("Failed to load image")),a.src=i})}function Se(i,e){return new Blob([new Uint8Array(i)],{type:e})}async function le(i){try{let e=await re(i.src,"anonymous"),n=document.createElement("canvas");n.width=e.naturalWidth,n.height=e.naturalHeight;let t=n.getContext("2d");if(!t)throw new Error("Failed to get canvas context");t.drawImage(e,0,0);let a=await new Promise(s=>{n.toBlob(s)});if(!a)throw new Error("Failed to create blob");let o=new ClipboardItem({[a.type]:a});await navigator.clipboard.write([o])}catch(e){throw m("Copy to clipboard failed:",e),e instanceof Error&&e.message.includes("Document is not focused")?new Error("Please click in the editor first, then try copying again"):e}}var he=require("obsidian");function B(i,e,n,t){return i=i.replace(v,(a,o,s,r)=>{let l=T.call(this,s);if(!N.call(this,l.path,e,n))return a;l.params=t(l.params);let c=W.call(this,l);return`${o}${c}${r}`}),i.replace(S,(a,o,s)=>{let r=T.call(this,o,s);if(!N.call(this,r.path,e,n))return a;let l=o.split("|")[0].trim()||n.basename;return r.params=t(r.params),`![${r.params.length>0?[l,...r.params].join("|"):l}](${W.call(this,{...r,params:[]},!0)})`})}function T(i,e){let n=e!=null?e:i;if(e)try{n=decodeURIComponent(n)}catch(c){}let[t,a]=n.split("#",2),o=a?`#${a}`:"",[s,...r]=(e?i:t).split("|");return{path:e?t:s,hash:o,params:r,isWikiStyle:!e}}function W(i,e=!1){let n=i.params.length>0?`|${i.params.join("|")}`:"",t=i.path;return e&&(t=i.path.split("/").map(a=>encodeURIComponent(a)).join("/")),`${t}${n}${i.hash}`}async function ce(i,e){let n=this.app.workspace.getActiveFile();if(!n)throw new Error("No active file, cannot update link.");if(n.path===i.path)return!1;if(!this.app.workspace.getActiveViewOfType(he.MarkdownView))throw new Error("No active MarkdownView to update.");let a=await this.app.vault.read(n),o=a,s=-1;a.startsWith(`---
`)&&(s=a.indexOf(`
---
`,4),s!==-1&&(s+=5,o=a.substring(s)));let r=B.call(this,o,n,i,e);if(r!==o)try{return await this.app.vault.process(n,l=>s!==-1?l.substring(0,s)+r:r),!0}catch(l){throw m("Failed to update file content:",l),new Error("Failed to update image link")}return!1}function N(i,e,n){let t=this.app.metadataCache.getFirstLinkpathDest(i,e.path);return!t||n&&t.path!==n.path?null:t}var g=require("obsidian"),ge=require("path"),pe=require("child_process");var me=require("obsidian"),k=class extends me.Modal{constructor(n,t,a){super(n);this.result=null;this.originalName=t,this.onSubmit=a}onOpen(){let{contentEl:n}=this;n.empty(),n.addClass("pixel-perfect-rename-modal"),n.createEl("h2",{text:"Rename image",cls:"modal-title"});let t=n.createEl("form");t.addClass("pixel-perfect-rename-form");let a=t.createEl("input",{type:"text",value:this.originalName,cls:"pixel-perfect-rename-input"}),o=this.originalName.lastIndexOf(".");if(o>0){let c=this.originalName.substring(0,o);a.setSelectionRange(0,c.length)}let s=t.createDiv();s.addClass("pixel-perfect-button-container");let r=s.createEl("button",{text:"Rename",type:"submit",cls:"mod-cta"});s.createEl("button",{text:"Cancel",type:"button"}).addEventListener("click",()=>{this.onSubmit(null),this.close()}),t.addEventListener("submit",c=>{c.preventDefault();let u=a.value.trim();u&&u!==this.originalName?this.onSubmit(u):this.onSubmit(null),this.close()}),a.focus()}onClose(){let{contentEl:n}=this;n.empty(),this.result===void 0&&this.onSubmit(null)}};function de(i,e){var o;let n=(o=i.getAttribute("src"))!=null?o:"",t=i.getAttribute("alt"),a=_.call(this,n);if(a){let s=this.resolveLink(a,e);if(s)return s}if(t){t=t.split("|")[0].trim();let s=this.resolveLink(t,e);if(s)return s}return null}function _(i){try{let e=decodeURIComponent(i),[n]=e.split("?"),t=n.lastIndexOf("/");return t<0||t>=n.length-1?null:n.substring(t+1)}catch(e){return null}}async function ue(i){let e=this.app.workspace.getActiveFile();if(!e)return null;let n=this.getFileForImage(i,e);return n?{activeFile:e,imgFile:n}:((i.naturalWidth>0||i.src)&&new g.Notice("Could not locate image file"),null)}async function fe(i){this.app.showInFolder(i.path)}async function we(i){this.app.openWithDefaultApp(i.path)}function Ie(i){let e=F(this.settings),n=this.settings.externalEditorName.trim()||"External Editor";if(!e){new g.Notice(`Please set your ${n} path in Pixel Perfect Image settings.`);return}let t=this.app.vault.adapter;if(!(t instanceof g.FileSystemAdapter)){new g.Notice("Cannot open file: Vault is not a FileSystemAdapter");return}let a=t.getBasePath(),o=(0,ge.join)(a,(0,g.normalizePath)(i)),s;g.Platform.isMacOS?s=`open -a "${e}" "${o}"`:s=`"${e}" "${o}"`,(0,pe.exec)(s,r=>{r&&(m(`Error launching ${n}:`,r),new g.Notice(`Could not open file in ${n}.`))})}async function xe(i){var n;let e=await Z.call(this,i);if(e)try{let a=`${((n=i.parent)==null?void 0:n.path)||"/"}/${e}`;await this.app.fileManager.renameFile(i,a),new g.Notice("Image renamed successfully")}catch(t){m("Failed to rename file:",t),new g.Notice("Failed to rename image")}}async function Z(i){return new Promise(e=>{new k(this.app,i.name,t=>{e(t)}).open()})}var D=class extends be.Plugin{constructor(){super(...arguments);this.dimensionCache=new Map;this.isModifierKeyHeld=!1;this.wheelEventCleanup=null;this.setModifierKeyState=b.bind(this);this.registerWheelEvents=j.bind(this);this.isModifierKeyMatch=M.bind(this);this.isModifierKeyStillHeld=O.bind(this);this.handleImageWheel=H.bind(this);this.handleImageClick=U.bind(this);this.registerImageContextMenu=q.bind(this);this.handleContextMenu=C.bind(this);this.addDimensionsMenuItem=z.bind(this);this.addResizeMenuItems=$.bind(this);this.addFileOperationMenuItems=V.bind(this);this.addMenuItem=p.bind(this);this.createMenuClickHandler=K.bind(this);this.resizeImage=te.bind(this);this.updateImageLinkWidth=ie.bind(this);this.removeImageWidth=ne.bind(this);this.readImageDimensions=ae.bind(this);this.calculateImageScale=se.bind(this);this.getCurrentImageWidth=oe.bind(this);this.copyImageToClipboard=le.bind(this);this.updateLinks=B.bind(this);this.parseLinkComponents=T.bind(this);this.buildLinkPath=W.bind(this);this.updateImageLinks=ce.bind(this);this.resolveLink=N.bind(this);this.getFileForImage=de.bind(this);this.parseFileNameFromSrc=_.bind(this);this.getImageFileWithErrorHandling=ue.bind(this);this.showInSystemExplorer=fe.bind(this);this.openInDefaultApp=we.bind(this);this.openInExternalEditor=Ie.bind(this);this.renameImage=xe.bind(this);this.promptForNewName=Z.bind(this);this.findImageElement=f.bind(this);this.errorLog=m.bind(this)}async onload(){await this.loadSettings(),this.addSettingTab(new y(this.app,this)),this.registerImageContextMenu(),this.registerDomEvent(document,"click",this.handleImageClick),this.registerEvent(this.app.workspace.on("layout-change",()=>this.registerWheelEvents(window))),this.registerWheelEvents(window)}onunload(){this.isModifierKeyHeld=!1,this.dimensionCache.clear()}async loadSettings(){this.settings=Object.assign({},R,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}};

/* nosourcemap */